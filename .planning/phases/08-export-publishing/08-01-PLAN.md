---
phase: 08-export-publishing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - requirements.txt
  - src/exporters/__init__.py
  - src/exporters/base_exporter.py
  - src/exporters/export_validator.py
  - tests/test_export_validator.py
autonomous: true

must_haves:
  truths:
    - "BaseExporter provides abstract interface for all export formats"
    - "ExportValidator checks content completeness before export"
    - "python-docx dependency is installed and importable"
  artifacts:
    - path: "src/exporters/__init__.py"
      provides: "Exporter package initialization"
    - path: "src/exporters/base_exporter.py"
      provides: "Abstract base class for exporters"
      exports: ["BaseExporter"]
    - path: "src/exporters/export_validator.py"
      provides: "Pre-export content validation"
      exports: ["ExportValidator"]
    - path: "requirements.txt"
      provides: "python-docx dependency"
      contains: "python-docx"
  key_links:
    - from: "src/exporters/export_validator.py"
      to: "src/validators/validation_report.py"
      via: "ValidationReport import"
      pattern: "from src.validators.validation_report import ValidationReport"
---

<objective>
Create export infrastructure: BaseExporter abstract class, ExportValidator for pre-export content verification, and python-docx dependency.

Purpose: Establishes foundation for all export formats with consistent interface and validation.
Output: src/exporters/ package with base class and validator, updated requirements.txt
</objective>

<execution_context>
@C:\Users\gpt30\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\gpt30\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-export-publishing/08-RESEARCH.md
@src/core/models.py
@src/validators/validation_report.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add python-docx dependency and create exporter package</name>
  <files>requirements.txt, src/exporters/__init__.py, src/exporters/base_exporter.py</files>
  <action>
1. Add `python-docx>=1.2.0` to requirements.txt (after pydantic line)
2. Run `pip install -r requirements.txt` to install
3. Create `src/exporters/__init__.py` with exports for BaseExporter, ExportValidator
4. Create `src/exporters/base_exporter.py` with abstract BaseExporter class:
   - Abstract method `export(self, course: Course) -> Tuple[BytesIO, str]` returning (buffer, filename)
   - Abstract property `content_type` returning MIME type string
   - Abstract property `file_extension` returning extension string (e.g., ".zip", ".docx")
   - Concrete method `get_download_filename(course: Course) -> str` that sanitizes course title and appends extension
   - Use `from abc import ABC, abstractmethod`
   - Use `from io import BytesIO`
   - Use `from typing import Tuple`

Filename sanitization: Replace spaces with underscores, remove special characters except alphanumeric/underscore/hyphen, limit to 50 chars.
  </action>
  <verify>
`python -c "from src.exporters import BaseExporter; from docx import Document; print('OK')"`
  </verify>
  <done>BaseExporter importable, python-docx installed</done>
</task>

<task type="auto">
  <name>Task 2: Create ExportValidator with content completeness checking</name>
  <files>src/exporters/export_validator.py, tests/test_export_validator.py</files>
  <action>
1. Create `src/exporters/export_validator.py`:
   - Class `ExportValidator` with `__init__` creating `ValidationReport` instance
   - Method `validate_for_export(course: Course) -> Dict[str, Any]` returning:
     ```python
     {
       "ready": bool,           # True if exportable
       "missing_content": [],   # List of activity paths with no content
       "validation_errors": [], # Errors from ValidationReport
       "warnings": []           # Warnings from ValidationReport
     }
     ```
   - Method `get_missing_content(course: Course) -> List[str]` that traverses course and returns list of `"{module.title}/{lesson.title}/{activity.title}"` for activities where `activity.content` is empty string or None
   - Course is "ready" when: no missing_content AND no validation_errors (warnings OK)
   - Import ValidationReport: `from src.validators.validation_report import ValidationReport`

2. Create `tests/test_export_validator.py`:
   - Test `test_validate_complete_course_ready`: Course with all content filled returns ready=True
   - Test `test_validate_missing_content_not_ready`: Course with empty activity.content returns ready=False with missing_content list
   - Test `test_validate_with_validation_errors_not_ready`: Course that fails ValidationReport returns ready=False
   - Test `test_get_missing_content_paths`: Verify path format is "Module/Lesson/Activity"
   - Use fixtures from conftest.py (tmp_store, sample_course)

3. Update `src/exporters/__init__.py` to export ExportValidator
  </action>
  <verify>
`pytest tests/test_export_validator.py -v` - all tests pass
  </verify>
  <done>ExportValidator validates content completeness, 4+ tests passing</done>
</task>

</tasks>

<verification>
```bash
# All imports work
python -c "from src.exporters import BaseExporter, ExportValidator; print('OK')"

# Tests pass
pytest tests/test_export_validator.py -v

# python-docx importable
python -c "from docx import Document; print('OK')"
```
</verification>

<success_criteria>
- python-docx>=1.2.0 in requirements.txt and importable
- BaseExporter abstract class with export(), content_type, file_extension
- ExportValidator with validate_for_export() and get_missing_content()
- 4+ tests for ExportValidator passing
- All exports from src/exporters/__init__.py
</success_criteria>

<output>
After completion, create `.planning/phases/08-export-publishing/08-01-SUMMARY.md`
</output>
