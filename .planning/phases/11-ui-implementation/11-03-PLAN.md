---
phase: 11-ui-implementation
plan: 03
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - templates/dashboard.html
  - templates/partials/sidebar.html
  - static/css/pages/dashboard.css
  - static/js/pages/dashboard.js
  - app.py
autonomous: true

must_haves:
  truths:
    - "Dashboard displays user's courses in a grid"
    - "User can create a new course via modal dialog"
    - "User can delete a course with confirmation"
    - "Course cards show status indicators"
    - "Sidebar navigation is functional"
  artifacts:
    - path: "templates/dashboard.html"
      provides: "Course list with CRUD operations"
      contains: "course-grid"
    - path: "static/js/pages/dashboard.js"
      provides: "Dashboard interactivity"
      contains: "createCourse"
  key_links:
    - from: "templates/dashboard.html"
      to: "/api/courses"
      via: "fetch API"
      pattern: "api/courses"
    - from: "templates/partials/sidebar.html"
      to: "templates/dashboard.html"
      via: "include in base"
      pattern: "sidebar"
---

<objective>
Enhance the dashboard page with sidebar navigation and improved course management UI including modal dialogs for create/delete operations.

Purpose: The dashboard is the user's home after login. It needs to integrate with the new sidebar navigation and use proper modal dialogs instead of browser alerts.

Output: Updated dashboard with sidebar, course grid with status indicators, create course modal, delete confirmation modal.
</objective>

<execution_context>
@C:\Users\gpt30\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\gpt30\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/11-ui-implementation/11-CONTEXT.md
@.planning/phases/11-ui-implementation/11-01-SUMMARY.md
@templates/dashboard.html
@static/css/main.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Dashboard Template with Sidebar</name>
  <files>
    templates/dashboard.html
    static/css/pages/dashboard.css
  </files>
  <action>
Update dashboard to use new base template structure:

**templates/dashboard.html:**
- Extend updated base.html
- Set page_title block to "Dashboard"
- Set breadcrumb variable to just "Dashboard"
- Do NOT pass course variable (sidebar shows "Select a Course")
- Main content area:
  - Header row: "My Courses" title + "+ New Course" button
  - Course grid using CSS Grid (responsive: 3 cols on lg, 2 on md, 1 on sm)
  - Each course card shows:
    - Title
    - Description (truncated)
    - Module count badge
    - Activity count badge
    - Build state indicator (color-coded: draft=gray, in_progress=yellow, complete=green)
    - Updated date
    - "Open" and "Delete" buttons
  - Empty state with illustration/message when no courses
- Create Course Modal:
  - Modal with id="create-course-modal"
  - Form fields: title (required), description (optional)
  - Cancel and Create buttons
- Delete Confirmation Modal:
  - Modal with id="delete-course-modal"
  - Shows course title being deleted
  - Cancel and Delete buttons (Delete is danger style)

**static/css/pages/dashboard.css:**
- .dashboard-header: flex row with title and button
- .course-grid: CSS Grid with auto-fill, minmax(300px, 1fr)
- .course-card: extend .card from components.css
- .course-card .status-indicator: colored dot for build state
- .course-card .badge-row: flex row for badges
- .empty-state: centered with muted styling
- Responsive adjustments for grid columns
  </action>
  <verify>
Visit /dashboard:
- Sidebar appears on left
- Course cards display in responsive grid
- Cards show title, description, badges, status indicator
- Empty state appears when no courses
  </verify>
  <done>
Dashboard template updated with sidebar integration, improved card layout, and modal markup
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Dashboard JavaScript with Modal Dialogs</name>
  <files>
    static/js/pages/dashboard.js
    templates/dashboard.html
  </files>
  <action>
Replace prompt/confirm with modal dialogs:

**static/js/pages/dashboard.js:**

DashboardController class:
- createCourseModal: Modal instance for create dialog
- deleteCourseModal: Modal instance for delete dialog
- courseToDelete: stores course ID pending deletion

Methods:
- init(): bind event handlers, create Modal instances
- showCreateModal(): open create modal, focus title field
- handleCreateSubmit():
  - Get title and description from form
  - Validate title not empty
  - Call api.post('/courses', {title, description})
  - On success: close modal, reload page (or append card dynamically)
  - On error: show error in modal
- showDeleteModal(courseId, courseTitle):
  - Set courseToDelete
  - Update modal text with course title
  - Open delete modal
- handleDeleteConfirm():
  - Call api.delete(`/courses/${this.courseToDelete}`)
  - On success: close modal, remove card from DOM or reload
  - On error: show toast error
- viewCourse(courseId):
  - Navigate to /courses/{courseId}/planner

Event bindings:
- "+ New Course" button -> showCreateModal
- Each card "Open" button -> viewCourse
- Each card "Delete" button -> showDeleteModal
- Create modal form submit -> handleCreateSubmit
- Delete modal confirm button -> handleDeleteConfirm

Use the Modal class from components/modal.js for open/close/focus trapping.
Use api.js for fetch calls.
Use toast.js for success/error notifications.

**Update templates/dashboard.html:**
- Include dashboard.js in extra_scripts
- Add data-course-id and data-course-title to cards
- Wire up button onclick handlers
  </action>
  <verify>
On dashboard:
- Click "+ New Course" -> modal opens with form
- Enter title -> submit -> course created, appears in grid
- Cancel -> modal closes, no action
- Click "Delete" on card -> confirmation modal opens showing course title
- Confirm delete -> course removed from grid
- Cancel -> modal closes, no action
- Click "Open" -> navigates to planner page (404 OK for now, route in later plan)
  </verify>
  <done>
Dashboard uses modal dialogs for create/delete. No browser alerts. API calls use fetch wrapper. Toast notifications for feedback.
  </done>
</task>

<task type="auto">
  <name>Task 3: Wire Sidebar Navigation for Course Context</name>
  <files>
    templates/partials/sidebar.html
    app.py
  </files>
  <action>
Make sidebar context-aware:

**templates/partials/sidebar.html:**
Update to handle course context:
- If `course` variable is set:
  - Show course title at top (clickable, returns to that course's planner)
  - Enable all course-specific nav links
  - Highlight current page link (use `active_page` variable)
- If no `course`:
  - Show "Select a Course" at top
  - Disable/hide course-specific nav links (show only Dashboard)
  - Dashboard link always visible

Nav items structure:
```html
<a href="/dashboard" class="nav-item {% if active_page == 'dashboard' %}active{% endif %}">
  <span class="nav-icon">&#x1F3E0;</span>
  <span class="nav-text">Dashboard</span>
</a>
{% if course %}
<a href="/courses/{{ course.id }}/planner" class="nav-item {% if active_page == 'planner' %}active{% endif %}">
  <span class="nav-icon">&#x1F4CB;</span>
  <span class="nav-text">Planner</span>
</a>
<!-- ... other course pages ... -->
{% endif %}
```

**app.py:**
Update dashboard route to pass active_page:
```python
@app.route('/dashboard')
@login_required
def dashboard():
    courses = project_store.list_courses(user_id=current_user.id)
    return render_template('dashboard.html',
                         courses=courses,
                         active_page='dashboard',
                         breadcrumb=[{'title': 'Dashboard', 'url': '/dashboard'}])
```

Later plans will add course-specific routes that pass the `course` object.
  </action>
  <verify>
On dashboard:
- Sidebar shows "Select a Course" at top
- Only Dashboard link is enabled/visible
- Dashboard link is highlighted as active
- Collapse toggle still works
- State persists across refresh
  </verify>
  <done>
Sidebar navigation is context-aware. Shows appropriate links based on whether a course is selected. Active page highlighting works.
  </done>
</task>

</tasks>

<verification>
- Dashboard loads with sidebar visible
- Course cards display with all metadata
- Create course modal opens and submits correctly
- Delete confirmation modal works
- Sidebar collapse persists state
- Toast notifications appear for operations
- No JavaScript console errors
</verification>

<success_criteria>
1. Dashboard integrates with new sidebar layout
2. Course cards show title, description, badges, and status indicator
3. Create course uses modal dialog (not prompt)
4. Delete course uses confirmation modal (not confirm)
5. Sidebar shows "Select a Course" when no course active
6. Dashboard link is highlighted as active page
7. All API operations use fetch wrapper with error handling
</success_criteria>

<output>
After completion, create `.planning/phases/11-ui-implementation/11-03-SUMMARY.md`
</output>
